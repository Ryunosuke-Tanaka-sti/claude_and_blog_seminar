<h1>Claude API×GitHub Actions完全自動化でコスト60%削減！ブログ投稿システム構築術 | SIOS Tech. Lab</h1>


	
<div data-smooth-scroll="1" data-smooth-scroll-offset="24"><div><div><b>目次</b></div><div><ul><li><a href="#hajimeni"><span>1</span><span>はじめに</span></a></li><li><a href="#cheng_guo_wu"><span>2</span><span>成果物</span></a></li><li><a href="#GitHub_Claude_API_de_shi_xiansuru_jie_jueapurochi"><span>3</span><span>GitHub × Claude API で実現する解決アプローチ</span></a><ul><li><a href="#ji_benkonseputo"><span>3.1</span><span>基本コンセプト</span></a></li><li><a href="#shisutemu_quan_tino_liure"><span>3.2</span><span>システム全体の流れ</span></a></li></ul></li><li><a href="#kosuto_zui_shi_huano_ji_shu_de_gong_fuAPI_li_yong_liaowo_60_xue_jian"><span>4</span><span>コスト最適化の技術的工夫：API 利用料を 60% 削減</span></a><ul><li><a href="#1_HTML_qian_chu_liniyorutokun_xue_jian_yue_50_xue_jian"><span>4.1</span><span>1. HTML 前処理によるトークン削減（約 50% 削減）</span></a></li><li><a href="#2_puronputokyasshuno_huo_yong_yue_37_xue_jian"><span>4.2</span><span>2. プロンプトキャッシュの活用（約 37% 削減）</span></a></li><li><a href="#shi_jinokosuto_xue_jian_xiao_guo"><span>4.3</span><span>実際のコスト削減効果</span></a></li></ul></li><li><a href="#shisutemu_shi_zhuangno_xiang_xi"><span>5</span><span>システム実装の詳細</span></a><ul><li><a href="#purojekuto_gou_cheng"><span>5.1</span><span>プロジェクト構成</span></a></li><li><a href="#4_duan_jieno_tou_gao_wen_sheng_chengpurosesu"><span>5.2</span><span>4 段階の投稿文生成プロセス</span></a></li></ul></li><li><a href="#shi_jino_yun_yongfuro"><span>6</span><span>実際の運用フロー</span></a><ul><li><a href="#1_GitHub_Issue_deno_qi_dong"><span>6.1</span><span>1. GitHub Issue での起動</span></a></li><li><a href="#2_zi_dong_chu_lino_shi_xing"><span>6.2</span><span>2. 自動処理の実行</span></a></li><li><a href="#3_rebyucheng_renpurosesu"><span>6.3</span><span>3. レビュー・承認プロセス</span></a></li><li><a href="#4_yun_yong_shi_ji"><span>6.4</span><span>4. 運用実績</span></a></li></ul></li><li><a href="#xiao_guotomeritto"><span>7</span><span>効果とメリット</span></a><ul><li><a href="#ding_liang_dena_xiao_guo"><span>7.1</span><span>定量的な効果</span></a></li><li><a href="#ding_xing_denameritto"><span>7.2</span><span>定性的なメリット</span></a></li></ul></li><li><a href="#matometo_jin_houno_zhan_wang"><span>8</span><span>まとめと今後の展望</span></a><ul><li><a href="#jin_houno_fa_zhan_ke_neng_xing"><span>8.1</span><span>今後の発展可能性</span></a></li></ul></li></ul></div></div></div><h2><span>はじめに</span></h2><p>ども！最近はClaude Codeにべったりな龍ちゃんです。皆さんは技術ブログから SNS 投稿まで、コンテンツマーケティングの自動化に取り組んでいますか？エンジニアやっている傍らで、情報発信やXの運用なども行っています。</p><p>私たちのチームでも以前、<a href="https://tech-lab.sios.jp/archives/48231" target="_blank" rel="noopener" title="">Claude のプロジェクト機能でブログから X 投稿文を自動生成するシステム</a>を構築しました。これはこれで便利だったのですが、運用していくうちに以下の課題が明らかになったんですね。</p><p><strong>Claude プロジェクトの運用課題</strong></p><ul><li>Claude の契約者しか利用できず、チーム内での共有や協業に制限がある</li><li>システムプロンプトの更新が上書き保存となり、改善履歴や変更効果の追跡ができない</li><li>成果物が Claude 上や他ツールに分散し、管理とレビューワークフローが属人化しやすい</li></ul><p>「これは何とかしないと…」ということで、Claude API × GitHub Actions による完全自動化システムを構築することにしました。今回は設計思想から実装のポイント、コスト最適化まで詳しく解説していきますね。</p><h2><span>成果物</span></h2><p>今回の作成物は、.envファイルにClaude APIのAPI Keyを環境変数として入れることで動作するようになります。興味がある方はリポジトリを読んでみてください。こちらのリポジトリではPythonを書く環境をDevContainerで構築しています。</p><div><a href="https://github.com/Ryunosuke-Tanaka-sti/github-x-generate-demo" target="_blank" rel="noopener noreferrer"><div><img decoding="async" src="https://tech-lab.sios.jp/wp-content/uploads/sng/fcb2e3326cf9e7213ed1f50421e988a4."></div><div><span>参考</span><div>GitHub – Ryunosuke-Tanaka-sti/github-x-generate-demo</div><div>GitHub</div></div></a></div><h2><span>GitHub × Claude API で実現する解決アプローチ</span></h2><h3><span>基本コンセプト</span></h3><p>「GitHub だけでブログ URL から X 投稿文の生成・レビュー・公開まで完結」を目指しました。具体的には以下を実現しています：</p><ul><li><strong>ワンクリック起動</strong>: URL 入力で自動実行</li><li><strong>完全なバージョン管理</strong>: Git でプロンプト・成果物を管理</li><li><strong>チーム協業</strong>: 誰でもレビュー・承認可能</li><li><strong>コスト最適化</strong>: API 利用料を最小化</li></ul><h3><span>システム全体の流れ</span></h3><p>自動化フローは以下のようになります：</p><figure><img data-recalc-dims="1" decoding="async" width="880" height="154" src="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Flow.png?resize=880%2C154&amp;ssl=1" srcset="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Flow.png?w=982&amp;ssl=1 982w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Flow.png?resize=940%2C165&amp;ssl=1 940w" sizes="(max-width: 880px) 100vw, 880px"></figure><div><ol><li><strong>GitHub Issue でトリガー</strong>: 記事 URL をタイトルに入力してイシューを作成</li><li><strong>HTML 自動取得</strong>: Python スクリプトで記事本文を抽出・クリーニング</li><li><strong>Claude API で分析</strong>: プロンプトキャッシュを活用して 3 パターンの投稿文を生成</li><li><strong>PR 自動作成</strong>: 生成結果を含む Pull Request を自動作成</li><li><strong>レビュー・マージ</strong>: チームメンバーが内容を確認して承認</li></ol></div><p>このフローにより、Issue 作成から最終的な投稿文完成まで、すべて GitHub 上で完結できるようになりました。</p><h2><span>コスト最適化の技術的工夫：API 利用料を 60% 削減</span></h2><p>Claude API の利用において、最も大きなコスト要因はトークン数です。私たちは以下の 2 つのアプローチでコストを大幅に削減しました。</p><figure><img data-recalc-dims="1" decoding="async" width="644" height="487" src="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/5bd156fc0f4e676ff6934beaeca67492.png?resize=644%2C487&amp;ssl=1"></figure><h3><span>1. HTML 前処理によるトークン削減（約 50% 削減）</span></h3><p>当初はブログページの HTML を丸ごと送信していましたが、よく考えてみれば記事本文のみが必要なんですよね。Python スクリプトで以下の前処理を実装しました：</p><div><pre><code># 不要な HTML 要素の除去例
- ヘッダー・フッター・ナビゲーション
- サイドバー・広告・関連記事
- JavaScript・CSS・meta タグ
- コメント欄・SNS ボタン</code></pre></div><p>この前処理により入力トークン数を約 50% 削減、コストが半分になりました。</p><h3><span>2. プロンプトキャッシュの活用（約 37% 削減）</span></h3><p><a href="https://docs.anthropic.com/ja/docs/build-with-claude/prompt-caching" target="_blank" rel="noopener" title="">Claude API のプロンプトキャッシュ機能</a>を活用することで、システムプロンプト部分のトークン利用料を大幅に削減しました。</p><div><pre data-lang="Python"><code># プロンプトキャッシュの実装例
response = self.client.messages.create(
    model=self.model,
    max_tokens=4000,
    system=[
        {
            "type": "text",
            "text": self.system_prompt_content,
            "cache_control": {"type": "ephemeral"}  # キャッシュ設定
        }
    ],
    messages=[{"role": "user", "content": user_prompt}]
)</code></pre></div><p>システムプロンプトをキャッシュすることで、2 回目以降は約 37% のコスト削減を実現しています。</p><h3><span>実際のコスト削減効果</span></h3><p>両方の最適化を組み合わせることで、実行コスト $0.10 → $0.04 程度に削減できました。年間で考えるとかなりの削減効果ですね。</p><h2><span>システム実装の詳細</span></h2><h3><span>プロジェクト構成</span></h3><div><pre data-lang="Bash"><code>github-x-generate/
├── scripts/                          # 実行スクリプト群
│   ├── generate_posts_with_cache.py  # Claude API統合
│   ├── fetch_html_from_techlab.py    # HTML取得・前処理
│   └── simple_claude_api.py          # API クライアント
├── prompts/
│   └── system_prompt.md              # システムプロンプト定義
├── .github/workflows/
│   └── generate_PR_from_issue.yaml   # メイン自動化ワークフロー
├── posts/                            # 生成結果保存ディレクトリ
└── requirements.txt                  # Python 依存関係定義</code></pre></div><h3><span>4 段階の投稿文生成プロセス</span></h3><p>システムプロンプトでは、以下の 4 段階プロセスで高品質な投稿文を生成します：</p><p><strong>Phase 1: 記事分析・品質評価</strong></p><ul><li>技術的正確性の 5 段階評価</li><li>実装レベルの判定（プロトタイプ〜企業レベル）</li><li>対象読者レベルの特定</li></ul><p><strong>Phase 2: ハッシュタグ効果分析</strong></p><ul><li>Web 検索による最新トレンドの調査</li><li>エンジニア向け効果的ハッシュタグの選定</li></ul><p><strong>Phase 3: 3 パターンの投稿文作成</strong></p><ul><li>A パターン: 効果重視・数値訴求型</li><li>B パターン: 課題共感・解決提案型</li><li>C パターン: 技術トレンド・学習促進型</li></ul><p><strong>Phase 4: 誇張表現検証・修正</strong></p><ul><li>記事内容との照合による事実確認</li><li>根拠のない数値・効果の除去</li></ul><p>使用しているプロンプトはこちらのブログで解説をしています。</p><h2><span>実際の運用フロー</span></h2><h3><span>1. GitHub Issue での起動</span></h3><div><pre><code>https://tech-lab.sios.jp/archives/48173</code></pre></div><p>記事 URL をタイトルに入力して Issue を作成するだけで、GitHub Actions が自動起動します。これだけです！</p><figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="880" height="453" src="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Issue.png?resize=880%2C453&amp;ssl=1" srcset="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Issue.png?w=1920&amp;ssl=1 1920w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Issue.png?resize=1536%2C790&amp;ssl=1 1536w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Issue.png?resize=940%2C484&amp;ssl=1 940w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Issue.png?w=1760&amp;ssl=1 1760w" sizes="auto, (max-width: 880px) 100vw, 880px"></figure><h3><span>2. 自動処理の実行</span></h3><ul><li>HTML 記事の取得と本文抽出（約 30 秒）</li><li>Claude API による投稿文生成（約 45 秒）</li><li>PR 作成とメタデータ保存（約 15 秒）</li></ul><p>トータル 1 分半程度で完了します。</p><figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="880" height="632" src="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Actions.png?resize=880%2C632&amp;ssl=1" srcset="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Actions.png?w=1601&amp;ssl=1 1601w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Actions.png?resize=1536%2C1102&amp;ssl=1 1536w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-Actions.png?resize=940%2C675&amp;ssl=1 940w" sizes="auto, (max-width: 880px) 100vw, 880px"></figure><h3><span>3. レビュー・承認プロセス</span></h3><p>生成された PR には以下が含まれます：</p><figure><img data-recalc-dims="1" loading="lazy" decoding="async" width="880" height="1894" src="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-PR.png?resize=880%2C1894&amp;ssl=1" srcset="https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-PR.png?w=892&amp;ssl=1 892w, https://i0.wp.com/tech-lab.sios.jp/wp-content/uploads/2025/09/GitHub-PR.png?resize=714%2C1536&amp;ssl=1 714w" sizes="auto, (max-width: 880px) 100vw, 880px"></figure><ul><li><strong>3 パターンの投稿文</strong>: 異なるアプローチの投稿候補</li><li><strong>品質評価データ</strong>: 技術的正確性や対象読者の分析結果</li><li><strong>コスト情報</strong>: 実際の API 利用料とトークン使用量</li></ul><p>レビュアーは内容を確認し、必要に応じて微調整を加えてからマージするだけです。</p><h3><span>4. 運用実績</span></h3><p>23 件の技術記事で運用実績があり、Azure・インフラ、AI・Claude、Git・CI/CD、Docker・コンテナなど多様な技術分野で安定動作を確認しています。</p><h2><span>効果とメリット</span></h2><h3><span>定量的な効果</span></h3><p><strong>コスト削減効果</strong></p><ul><li>HTML 前処理: 50% トークン削減</li><li>プロンプトキャッシュ: 37% トークン削減</li><li>総合的なコスト削減: 約 60%</li></ul><p><strong>工数削減効果</strong></p><ul><li>投稿文作成時間: 30 分 → 3 分（90% 削減）</li><li>レビュー・修正工程: 20 分 → 5 分（75% 削減）</li><li>全体工程: 1 時間 → 10 分（83% 削減）</li></ul><h3><span>定性的なメリット</span></h3><p><strong>チーム協業の向上</strong></p><ul><li>誰でも投稿文生成を実行可能</li><li>GitHub ベースのレビューワークフロー</li><li>知見の蓄積とバージョン管理</li></ul><p><strong>品質の向上</strong></p><ul><li>誇張表現の自動検出・修正</li><li>記事内容との整合性保証</li><li>3 パターンによるA/Bテスト可能</li></ul><p><strong>運用の効率化</strong></p><ul><li>Issue 作成からマージまで自動化</li><li>エラー時の詳細な診断情報</li><li>成果物の一元管理</li></ul><p>これは想像以上に効果的でした。特に複数人でのコンテンツマーケティングには必須のツールになりそうですね。</p><h2><span>まとめと今後の展望</span></h2><p>Claude API × GitHub Actions により、個人プロジェクトでは困難だった「チーム協業」「バージョン管理」「コスト最適化」を同時実現することができました。約 60% のコスト削減と GitHub 完結型ワークフローにより、効率的な運用が可能になります。</p><h3><span>今後の発展可能性</span></h3><ol><li><strong>他プラットフォーム展開</strong>: LinkedIn、Facebook 対応</li><li><strong>多言語対応</strong>: 英語版投稿文の自動生成</li><li><strong>効果分析</strong>: エンジニアリング指標の追加連携</li><li><strong>統計分析活用</strong>: 蓄積データによるプロンプト最適化</li></ol><p>技術ブログのコンテンツマーケティング自動化にお悩みの方は、ぜひ参考にしてください。もし実装で困りごとがあれば連絡いただければお手伝いしますよ！！</p><!-- Anyway Feedback Container //--><div>ご覧いただきありがとうございます！

<span>この投稿はお役に立ちましたか？</span><br><br><a href="#afb-post-49116">役に立った</a><a href="#afb-post-49116">役に立たなかった</a><br><br><span>0人がこの投稿は役に立ったと言っています。</span><input type="hidden" name="post_type" value="post"><input type="hidden" name="object_id" value="49116"></div><!-- //Anyway Feedback Container -->