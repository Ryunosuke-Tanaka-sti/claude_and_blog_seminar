<!--
ブログ記事情報:
タイトル: Claude Code仕様書ベースでハマる6つの落とし穴！失敗回避の備忘録 | SIOS Tech. Lab
URL: https://tech-lab.sios.jp/archives/49154
OGP画像: https://tech-lab.sios.jp/wp-content/uploads/2025/09/7dd2097cc3370837a033f5fa9cc46b9d.png
抽出日時: 2025-11-07T20:47:57.429Z
-->

<h1>Claude Code仕様書ベースでハマる6つの落とし穴！失敗回避の備忘録 | SIOS Tech. Lab</h1>


	
<div data-smooth-scroll="1" data-smooth-scroll-offset="24"><div><div><b>目次</b></div><div><ul><li><a href="#chumeni"><span>1</span><span>初めに</span></a></li><li><a href="#1_domein_zhi_shino_ming_shi_denadokyumento_huano_zhong_yao_xing"><span>2</span><span>1. ドメイン知識の明示的なドキュメント化の重要性</span></a><ul><li><a href="#purojekutokoadokyumentono_ju_ti_li"><span>2.1</span><span>プロジェクトコアドキュメントの具体例</span></a></li></ul></li><li><a href="#2_AIgadokyumentowo_wu_shisuru_wen_tiheno_dui_chu"><span>3</span><span>2. AIがドキュメントを無視する問題への対処</span></a><ul><li><a href="#wu_shisareyasuipatanto_dui_ce"><span>3.1</span><span>無視されやすいパターンと対策</span></a></li></ul></li><li><a href="#3_shi_yang_shuno_shi_qiena_fen_liangbaransu"><span>4</span><span>3. 仕様書の適切な分量バランス</span></a><ul><li><a href="#ju_ti_dena_fen_liangno_mu_an"><span>4.1</span><span>具体的な分量の目安</span></a></li></ul></li><li><a href="#4_xin_ji_neng_kai_fatobagurepotono_shii_fenke"><span>5</span><span>4. 新機能開発とバグレポートの使い分け</span></a><ul><li><a href="#ren_jiangayattahouga_zaoi_bian_gengno_jian_jime"><span>5.1</span><span>人間がやったほうが早い変更の見極め</span></a></li></ul></li><li><a href="#5_zhong_gui_mo_kai_fadeno_wei_lito_xian_zaino_xian_jie"><span>6</span><span>5. 中規模開発での威力と現在の限界</span></a></li><li><a href="#6_yokuaru_shi_baipatantosono_dui_ce"><span>7</span><span>6. よくある失敗パターンとその対策</span></a><ul><li><a href="#xing_ding_yino_bu_zheng_he_wen_ti"><span>7.1</span><span>型定義の不整合問題</span></a></li><li><a href="#depuroi_huan_jingno_cha_yiniyoru_wen_ti"><span>7.2</span><span>デプロイ環境の差異による問題</span></a></li></ul></li><li><a href="#matome"><span>8</span><span>まとめ</span></a></li></ul></div></div></div><h2><span>初めに</span></h2><p>前回のブログでは「<a href="https://tech-lab.sios.jp/archives/49140">Claude Code革命！3フェーズ開発で効率的な開発：計画→実装→検証術</a>」について紹介しましたが、今回は実際にClaude Codeで仕様書ベース開発運用する際に「これは絶対に押さえておかないとハマる」というポイントについてお話しします。</p><p>実際に検証していて失敗したことや、気をつけないと時間を無駄にしてしまうポイントを中心にまとめました。</p><h2><span>1. ドメイン知識の明示的なドキュメント化の重要性</span></h2><p>この方法で検証していて失敗したこともあります。例えば、<strong>プロジェクトの基礎的な知識（ドメイン知識）は、明示的にドキュメント化しない限りAIは理解してくれません</strong>。</p><p>実際あった問題として、ネイティブアプリとWebアプリのバックエンドリンクの構成があります。ローカル環境ではSWCでエミュレートしていて、「/api」に自動でプロキシされる仕組みでしたが、AIはそれを知らずにバックエンドURLを直接埋め込もうとして、<strong>APIパスの参照エラーが多発</strong>しました。</p><p>これは「プロジェクトコア」のようなドキュメントを作成して共通知識を提供することで解決しました。<strong>AIは書かれていないことは認識できず、セッション内で与えていない情報は理解しません</strong>。</p><h3><span>プロジェクトコアドキュメントの具体例</span></h3><p>プロジェクトコアには、実際にデプロイする環境のプロキシの設計やプロジェクトの根幹に関わる部分をちゃんと定義しておくべきです。</p><p>今回私が作った環境では、Azure Static Web Appsをバックエンドリンクで構築していて、スラッシュAPIというのが自動でプレフィックスで飛んでいくという仕組みがあります。そのため、プレフィックス「/api」でアクセスするということを明記したり、プロジェクト構成みたいなのを書いておいて、そういった情報をAIに与えています。</p><p>当たり前のように思える環境設定や開発ルールも、AIにとっては「初めて聞く話」です。人間の開発者なら暗黙知として共有されている部分も、AIには明示的に教える必要があります。</p><h2><span>2. AIがドキュメントを無視する問題への対処</span></h2><p>計画フェーズでは「計画.md」などのファイルに指示を書いていますが、<strong>AIは時々ドキュメントを無視することがあります</strong>。人間と同じで、指示や定義を見ないこともあるんです。読んだうえで無視することもあるので、<strong>絶対守ってほしいことはドキュメント化し、プロンプトでも注意するのが重要</strong>です。</p><p>これは本当にイライラするポイントで、せっかく時間をかけて詳細な仕様書を作っても「それ、無視しちゃダメでしょ！」ということが頻繁に起こります。</p><h3><span>無視されやすいパターンと対策</span></h3><p>プロンプトに期待してない情報は割と無視しますね。そのパターン的なミスの傾向みたいなのがあったら、マークダウンファイルに情報反映させるというやり取りをよくやっています。</p><p>仕様書を書いてもらうフェーズと開発フェーズで、仕様書を書いている最中にコードの編集をしたりしていたんですよ。そこで、仕様要件フェーズと開発フェーズの三つに分けますという指示をつけて、計画フェーズではファイルの編集は加えないでくださいという指示を追加しています。開発フェーズは、作成した仕様のドキュメントを読んで、それに対してステップバイステップで開発を進めてくださいということを、マークダウンファイルで定義しています。</p><p>対策としては：</p><ul><li>最重要な制約事項はドキュメントに書く</li><li>さらにプロンプトでも再度強調する</li><li>「この部分だけは絶対に守ってください」という明示的な指示を含める</li></ul><p>二重、三重の安全策を講じることが大切です。</p><h2><span>3. 仕様書の適切な分量バランス</span></h2><p>仕様書の分量については、<strong>長すぎるとAIが無視する確率が上がります</strong>。「無視しました」という返答が返ってくることもあり、それを見たときは正直<strong>ブチ切れました</strong>（笑）。</p><p>短ければ理想的ですが、短すぎると時間がかかるので、AIが無視する可能性も考慮しながら適切な分量を見極める必要があります。<strong>どの程度の分量が適切かはプロジェクト依存</strong>です。ドメイン知識が多ければ、その分仕様書に書く情報は少なくて済みます。</p><h3><span>具体的な分量の目安</span></h3><p>私の環境で言うと、<strong>エンドポイント2つと、それに対応する画面1つ</strong>という感じだと、体感的に上手くいったという印象です。これは本当にプロジェクトによるというか、プロジェクトコアによる感じの内容というか、元のコンテキスト量が影響してきます。</p><p>この辺りは経験則になってしまいますが、AIが「長いから読みたくない」と判断するラインを見極めることが重要です。人間と同じで、あまりにも長い仕様書は最後まで読んでもらえません。</p><h2><span>4. 新機能開発とバグレポートの使い分け</span></h2><p>私は新機能開発とバグレポートをこの二つの方法で分けて対応しています。</p><ul><li><strong>新機能開発</strong>: 必ず3フェーズ（計画→実装→検証）を踏む</li><li><strong>小さな変更</strong>: でもドキュメント→実装という段階を踏む</li><li><strong>本当に小さな変更</strong>: 人間がやったほうが早い</li></ul><h3><span>人間がやったほうが早い変更の見極め</span></h3><p>プロジェクト構成的な部分の変更ですね。コード規約みたいなところで、ちょっと上の階層にファイルを移し替えたりとか、ファイル構成で、ちょっとこっちに移行させるほうがいいよねみたいな話とか、ファイルの単純な移動は、VS Codeの補完機能が優秀なので、そういった作業とか、あとは関数名が気に入らないので、関数名のリネームするという作業ですよね。</p><p>人間が手を動かして作業して、セッションが継続しているのであれば、ちゃんと変更を加えましたよということをAI側に伝えてあげる必要はあります。そうじゃないと、人間が編集したファイルとAIが編集しようとしているファイルでコンフリクト起きてしまうので、再度ファイルを作ろうとするんですよ。なので、そういったところで調整を取っていく必要はあるかなと思います。</p><p>この使い分けが重要で、何でもかんでもAIに頼めばいいというものではありません。1行2行の修正をAIに説明するより、自分でやってしまったほうが早いケースも多々あります。</p><p>プロセスを踏んでも意図したものができない場合は、やはり人間のドキュメントが不十分だということです。AIは書かれていないことを自由に判断するので、ドキュメントの質を高める必要があります。</p><h2><span>5. 中規模開発での威力と現在の限界</span></h2><p>現在はプライベートリポジトリで検証しているため、<strong>大規模プロジェクトへの導入経験はまだありません</strong>が、中規模程度の開発であれば強力なツールになると思います。特に<strong>プロトタイピングでは大きな力を発揮しそう</strong>です。</p><p>個人的に学びになった点としては、仕様書作成が苦手な私でも、AIが返してきた仕様書を見て「分かりやすい」と感じることがあります。<strong>学習的な側面でも価値がある</strong>と思います。</p><p>完璧な仕様書があれば理想的ですが、そういうものは実際には存在せず、どこかに不備があるものです。だからこそ、機能ごとに段階的に仕様書を作っていくアプローチが有効だと思います。</p><h2><span>6. よくある失敗パターンとその対策</span></h2><h3><span>型定義の不整合問題</span></h3><p>本当によくあるのが、フロントエンドとバックエンドで型定義が共通化されてなくて、バックエンドにアクセスできない、APIアクセスは成功してるんだけども、画面に表示がされないということがありました。</p><p>対策としては、<a href="https://tech-lab.sios.jp/archives/49157" target="_blank" rel="noopener" title=""><strong>OpenAPI スペックを作らせて、そのOpenAPIスペックから型定義を作成する</strong>。</a>そして、フロントエンドはその型定義を絶対に使用するようにする、という感じで回避しています。</p><h3><span>デプロイ環境の差異による問題</span></h3><p>デプロイ環境の差異みたいなところで問題が起きることもあります。今回Azure のバックエンドリンクで、スラッシュAPIのコンテンツを自動でプロキシしてくれるんですけど、そういったことを伝えてなくて、なんか別のエンドポイントベースURLみたいなのを付けて、そこにアクセスするようにしましょうみたいな提案をされました。</p><p>バックエンドが現状、localhost の3001番で動いてるので、ローカル3001番に直接アクセスするように変えちゃいましょう、みたいなことを言われることがあります。これはプロジェクトコアドキュメントでしっかりと環境構成を明記しておくことで回避できます。</p><h2><span>まとめ</span></h2><p>Claude Codeは確実に開発効率を向上させてくれるツールですが、これらのポイントを押さえておかないと、余計な時間を費やしてしまいます。特にドメイン知識の明示化と仕様書の分量バランスは、成功の鍵となる重要な要素です。</p><p>まぁ暴走するのは人間と一緒って感じですね。人間よりも暴走しがちですが、言いやすい相手ですよねｗ</p><p>皆さんも、ぜひこれらのポイントを参考にClaude Codeを活用してみてください！</p><!-- Anyway Feedback Container //--><div>ご覧いただきありがとうございます！

<span>この投稿はお役に立ちましたか？</span><br><br><a href="#afb-post-49154">役に立った</a><a href="#afb-post-49154">役に立たなかった</a><br><br><span>0人がこの投稿は役に立ったと言っています。</span><input type="hidden" name="post_type" value="post"><input type="hidden" name="object_id" value="49154"></div><!-- //Anyway Feedback Container -->